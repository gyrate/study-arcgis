(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-196bbbbc"],{"01f2":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a}));var r=n("38a4");const a=(()=>{if(!("document"in globalThis))return()=>null;const e=document.createElement("canvas"),t=e.getContext("2d"),n=512;return e.height=n,e.width=1,n=>{t.clearRect(0,0,1,e.height);const r=t.createLinearGradient(0,0,0,e.height);for(const{ratio:e,color:t}of n.colorStops)r.addColorStop(Math.max(e,.001),`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`);return t.fillStyle=r,t.fillRect(0,0,1,e.height),t.getImageData(0,0,1,e.height).data}})();function o(e,t,n,r){const{blurRadius:a,fieldOffset:o,field:i}=t,s=new Float64Array(n*r),d=c(a),u=Math.round(3*a);let f,h=Number.NEGATIVE_INFINITY;const b=l(i,o),p=new Set;for(const c of e){const e=c.getCursor();for(;e.next();){const t=e.getObjectId();if(p.has(t))continue;p.add(t);const a=e.readLegacyPointGeometry(),o=128;if(a.x<-o||a.x>=n+o||a.y<-o||a.y>r+o)continue;const i=+b(e),c=Math.round(a.x)-u,l=Math.round(a.y)-u,y=Math.max(0,c),O=Math.max(0,l),w=Math.min(r,Math.round(a.y)+u),m=Math.min(n,Math.round(a.x)+u);for(let e=O;e<w;e++){const t=d[e-l];for(let r=y;r<m;r++){const a=d[r-c];f=s[e*n+r]+=t*a*i,f>h&&(h=f)}}}}return{matrix:s.buffer,max:h}}function i(e,t,n,r,a,o){e.canvas.width=e.canvas.height=t,e.clearRect(0,0,t,t);const i=e.getImageData(0,0,t,t);n&&r&&i.data.set(new Uint8ClampedArray(s(t,n,r,a,o))),e.putImageData(i,0,0)}function s(e,t,n,a,o){const i=new Uint32Array(e*e),s="buffer"in t?t:new Float64Array(t),c="buffer"in n?new Uint32Array(n.buffer):new Uint32Array(new Uint8Array(n).buffer),l=c.length/(o-a);for(let d=0;d<s.length;d++){const e=s[d],t=Math.floor((e-a)*l);i[d]=c[Object(r["f"])(t,0,c.length-1)]}return i.buffer}function c(e){const t=Math.round(3*e),n=2*e*e,r=new Float64Array(2*t+1);for(let a=0;a<=r.length;a++)r[a]=Math.exp(-((a-t)**2)/n)/Math.sqrt(2*Math.PI)*(e/2);return r}function l(e,t){return null!=e?"string"==typeof t?t=>-1*+t.readAttribute(e):n=>+n.readAttribute(e)+t:e=>1}},"331e":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return b}));var r=n("a4ee"),a=(n("c120"),n("b2b2")),o=(n("e92d"),n("cea0"),n("b50f"),n("2dd4"),n("d386")),i=n("0f1c"),s=n("01f2"),c=n("8c81"),l=n("ba46"),d=n("a015");class u{constructor(e,t){this.offset=e,this.extent=t}}function f(e){const t=e.key,n=new Map,r=256,a=c["L"],o=e.tileInfoView.tileInfo.isWrappable;return n.set(Object(d["a"])(t,-1,-1,o).id,new u([-a,-a],[a-r,a-r,a,a])),n.set(Object(d["a"])(t,0,-1,o).id,new u([0,-a],[0,a-r,a,a])),n.set(Object(d["a"])(t,1,-1,o).id,new u([a,-a],[0,a-r,r,a])),n.set(Object(d["a"])(t,-1,0,o).id,new u([-a,0],[a-r,0,a,a])),n.set(Object(d["a"])(t,1,0,o).id,new u([a,0],[0,0,r,a])),n.set(Object(d["a"])(t,-1,1,o).id,new u([-a,a],[a-r,0,a,r])),n.set(Object(d["a"])(t,0,1,o).id,new u([0,a],[0,0,a,r])),n.set(Object(d["a"])(t,1,1,o).id,new u([a,a],[0,0,r,r])),n}let h=class extends l["a"]{constructor(){super(...arguments),this.type="heatmap",this._tileKeyToFeatureSets=new Map}initialize(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))])}async update(e,t){const n=t.schema.processors[0];"heatmap"===n.type&&Object(i["a"])(this._schema,n)&&(e.mesh=!0,this._schema=n)}onTileUpdate(e){for(const t of e.removed)this._tileKeyToFeatureSets.delete(t.key.id)}onTileClear(e){const t={clear:!0};return this._tileKeyToFeatureSets.delete(e.key.id),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:e.id,data:t})}async onTileMessage(e,t,n){this._tileKeyToFeatureSets.has(e.key.id)||this._tileKeyToFeatureSets.set(e.key.id,new Map);const r=this._tileKeyToFeatureSets.get(e.key.id);if(Object(a["l"])(t.addOrUpdate)&&t.addOrUpdate.hasFeatures&&r.set(t.addOrUpdate.instance,t),t.end){const t=[],r=f(e);this._tileKeyToFeatureSets.forEach((n,o)=>{if(o===e.key.id)n.forEach(e=>Object(a["b"])(e.addOrUpdate,e=>t.push(e)));else if(r.has(o)){const e=r.get(o),[i,s]=e.offset;n.forEach(e=>Object(a["b"])(e.addOrUpdate,e=>{const n=e.transform(i,s,1,1);t.push(n)}))}});const o=Object(s["a"])(t,this._schema.mesh,512,512),i={tileKey:e.key.id,intensityInfo:o},c=[o.matrix];return this.remoteClient.invoke("tileRenderer.onTileData",i,{...n,transferList:c})}}onTileError(e,t,n){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:e.id,error:t},n)}};h=Object(r["a"])([Object(o["a"])("esri.views.2d.layers.features.processors.HeatmapProcessor")],h);const b=h},a015:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n("ee0e");function r(e,t,n,r){const a=e.clone(),o=1<<a.level,i=a.col+t,s=a.row+n;return r&&i<0?(a.col=i+o,a.world-=1):i>=o?(a.col=i-o,a.world+=1):a.col=i,a.row=s,a}},ba46:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("a4ee"),a=n("9096"),o=n("59b2"),i=(n("b50f"),n("c120"),n("cea0"),n("d386"));let s=class extends a["a"]{initialize(){}destroy(){}get supportsTileUpdates(){return!1}get spatialReference(){const e=this.get("tileStore.tileScheme.spatialReference");return e&&e.toJSON()||null}};Object(r["a"])([Object(o["b"])({readOnly:!0})],s.prototype,"supportsTileUpdates",null),Object(r["a"])([Object(o["b"])({constructOnly:!0})],s.prototype,"remoteClient",void 0),Object(r["a"])([Object(o["b"])({constructOnly:!0})],s.prototype,"service",void 0),Object(r["a"])([Object(o["b"])()],s.prototype,"spatialReference",null),Object(r["a"])([Object(o["b"])({constructOnly:!0})],s.prototype,"tileInfo",void 0),Object(r["a"])([Object(o["b"])({constructOnly:!0})],s.prototype,"tileStore",void 0),s=Object(r["a"])([Object(i["a"])("esri.views.2d.layers.features.processors.BaseProcessor")],s);const c=s}}]);